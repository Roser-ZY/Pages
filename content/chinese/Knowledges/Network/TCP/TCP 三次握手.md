---
title: "TCP 三次握手"
author: "Roser"
date: 2025-05-09
image: "images/content/Network.png"
draft: false
tags:
  - Network
  - TCP
  - Review
sr-due: 2025-08-07
sr-interval: 104
sr-ease: 250
---
为什么是三次握手？

因为三次握手能保证双方具有接受和发送的能力。在三个方面上考虑：
- 阻止重复历史连接的初始化（主要原因）。
- 同步双方的初始序列号。
- 避免资源浪费。

三次握手示意图如下：

![](images/三次握手.png)

在握手前，服务器处于 LISTEN 状态，而客户端处于 CLOSE 状态。客户端主动发起连接请求后，进入三次握手。

- **第一次握手**（客户端发送 SYN 报文）：客户端向服务器发送一个带有 SYN 标志的报文，这个报文表示客户端希望建立连接，并且包含一个初始序列号（Sequence Number）。
	该报文不包含应用层数据。发送完这个报文后，客户端进入 SYN-SENT 状态，等待服务器的响应。

- **第二次握手**（服务器发送 SYN+ACK 报文）：服务器收到客户端的 SYN 报文后，确认收到了该报文，并向客户端发送一个带有 SYN 和 ACK 标志的报文作为回应。这个报文中包含服务器的初始序列号和对客户端序列号的确认（即 ACK Number = 客户端序列号 + 1）。**注意服务器的初始序列号与客户端的初始序列号是无关的**。
	该报文同样不包含应用层数据。发送完该报文后，服务器进入 SYN-RECEIVED 状态。

- **第三次握手**（客户端发送 ACK 报文）：客户端收到服务器的 SYN+ACK 报文后，发送一个带有 ACK 标志的报文，确认收到了服务器的序列号（即 ACK Number = 服务器序列号 + 1）。
	该报文可以携带客户端数据。客户端发送完报文后，进入 ESTABLISHED 状态，连接正式建立。服务器在收到这个 ACK 报文后，也进入 ESTABLISHED 状态。
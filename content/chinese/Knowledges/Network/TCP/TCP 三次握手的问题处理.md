---
title: "TCP 三次握手的问题处理"
author: "Roser"
date: 2025-05-09
image: "images/content/Network.png"
draft: false
tags:
  - Network
  - TCP
  - Review
sr-due: 2025-08-08
sr-interval: 105
sr-ease: 250
---
[TCP 三次握手](../TCP-三次握手)是非常可靠的建立连接的方式，当握手过程网络发生问题，会有以下解决方案。

| 节点    | 问题           | 处理方式                                                                                                                            | 失败结果                                                                                                     |
| ----- | ------------ | ------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------- |
| 第一次握手 | SYN 报文丢失     | TCP 协议有重传机制，如果客户端在一定时间内没有收到服务器的响应（SYN-ACK 报文），它会重发 SYN 报文。这种重传会持续一段时间，直到收到服务器的响应或超过重传次数。                                        | 如果超过重传次数，客户端会放弃连接尝试，返回连接失败的错误。                                                                           |
| 第二次握手 | SYN-ACK 报文丢失 | - 客户端重传：客户端在等待一定时间后，如果没有收到 SYN+ACK 报文，会重发 SYN 报文（触发服务器重发 SYN+ACK 报文）；<br><br>- 服务端重传：如果服务器没有收到客户端的确认（ACK 报文），它会超时重传 SYN+ACK 报文； | 如果服务器的重传 SYN+ACK 报文仍未到达客户端，客户端可能继续重发 SYN 报文，直到超过重传次数，放弃连接。                                               |
| 第三次握手 | ACK 报文丢失     | - 服务端超时重传：服务器在未收到 ACK 报文的情况下，会重传 SYN+ACK 报文，以确保客户端收到并确认连接请求；                                                                    | 如果 ACK 报文仍未到达服务器，服务器最终会超时放弃连接，导致连接失败。 此时，客户端已经进入了 ESTABLISH 阶段，当客户端发送数据时，由于服务端已关闭，因此会收到 RST 报文，表示该连接已重置。 |
注意，第三次握手中，ACK 报文是不会重传的，如果客户端 ACK 报文丢失，则由服务端重传报文。